{"version":3,"sources":["solve.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["//Make magic happen\r\n//Function to load new trio\r\n//This function fills out the trio screen\r\n//Extracted to avoid repetition\r\nfunction loadTrio(trio, flip) {\r\n    if (flip) {\r\n        $(\".panel\").addClass(\"flip\");\r\n        setTimeout(function() {\r\n            $(\".panel\").removeClass(\"flip\");\r\n        }, 600);\r\n    }\r\n\r\n    var blank = \"<span class='blank'></span>\";\r\n    setTimeout(function() {\r\n        $(\"#sentences li\").html(function() {\r\n            return trio[this.id].replace(\"$@$\", blank);\r\n        });\r\n        $(\"#trio-id\").html(trio.id);\r\n    }, flip ? 300 : 0);\r\n\r\n    var sentencesArr = [trio.sentence1, trio.sentence2, trio.sentence3];\r\n    var sentences = encodeURIComponent(sentencesArr.join(\"\\r\\n\"));\r\n    location.hash = \"#\" + trio.id;\r\n}\r\n\r\nfunction updateStats(stats) {\r\n    $(\"#trios-solved\").text(stats.solved);\r\n    $(\"#trios-attempted\").text(stats.attempted);\r\n}\r\n\r\nfunction fillBlanks(text) {\r\n    $(\"#sentences li .blank\").text(text);\r\n}\r\n\r\n$(document).ready(function() {\r\n    // 0 - white, check\r\n    // 1 - red, try again\r\n    // 2 - green, next trio\r\n    var checkButtonState = 0;\r\n\r\n    // 0 - red, i don't know\r\n    // 1 - red, next trio\r\n    var idkButtonState = 0;\r\n\r\n    var hash = location.hash.slice(1);\r\n    //AJAX magic\r\n    //On first load fetch a random trio\r\n    $.getJSON(\"/api/solve/\"+hash, function(trio) {\r\n        //Fill the page\r\n        loadTrio(trio, false);\r\n    }).fail(function() {\r\n        alert(\"We're having some trouble fetching a new Trio for you. :< Please try again.\");\r\n    });\r\n\r\n    //After user inputs answer and clicks check\r\n    $(\"#check-button\").on(\"click\", function (e) {\r\n        e.preventDefault();\r\n        var trio_id = parseInt($(\"#trio-id\").text());\r\n        $(\".panel\").removeClass(\"wrong\");\r\n\r\n        //IF the button was already green, load next trio\r\n        if (checkButtonState == 2) {\r\n            //Make JSON request\r\n            $.getJSON(\"/api/solve\", function(trio) {\r\n                //Fill the page\r\n                loadTrio(trio, true);\r\n            });\r\n            $(\"#check-button\")\r\n                .removeClass(\"btn-success\")\r\n                .removeClass(\"btn-danger\")\r\n                .addClass(\"btn-primary\")\r\n                .html(\"Check\");\r\n            $(\"#idk-button\").prop(\"disabled\", false);\r\n            //Clear the text input\r\n            $(\"#answer\").val(\"\");\r\n            checkButtonState = 0;\r\n            return;\r\n        }\r\n\r\n        //Get answer\r\n        var answer = $(\"#answer\").val();\r\n        //Send POST check request to /api/solve/{trio}\r\n        $.post(\"/api/solve/\" + trio_id, {\r\n            answer: answer,\r\n            _token: $(\"meta[name='csrf-token']\").attr(\"content\")\r\n        }).done(function (ret) {\r\n            if(ret.answer.isCorrect == true) {\r\n                //IF answer is correct, change button to green and change text to \"Next trio\"\r\n                $(\"#check-button\")\r\n                    .removeClass(\"btn-danger\")\r\n                    .removeClass(\"btn-primary\")\r\n                    .addClass(\"btn-success\")\r\n                    .html(\"Correct, next trio→\");\r\n                $(\"#idk-button\").prop(\"disabled\", true);\r\n\r\n                //Fill out the sentences\r\n                fillBlanks(ret.answer.attemptedAnswer);\r\n                checkButtonState = 2;\r\n            } else {\r\n                //ELSE if answer is not correct, change button to red and change text to \"try again\"\r\n                $(\".panel\").addClass(\"wrong\");\r\n                $(\"#check-button\")\r\n                    .removeClass(\"btn-primary\")\r\n                    .addClass(\"btn-danger\")\r\n                    .html(\"Try again\");\r\n                checkButtonState = 1;\r\n            }\r\n        });\r\n\r\n        if(ret.stats !== undefined) {\r\n            updateStats(ret.stats);\r\n        }\r\n\r\n    });\r\n\r\n    //ON I don't know click or green buton click, save the click and load new random trio\r\n    $(\"#idk-button\").click(function (e) {\r\n        e.preventDefault();\r\n        var trio_id = $(\"#trio-id\").text();\r\n        $(\".panel\").removeClass(\"wrong\");\r\n\r\n        if(idkButtonState == 0) {\r\n            //jest napis I don't know\r\n            //zapisujemy click na I don't know\r\n            $.post(\"/api/solve/\" + trio_id, {\r\n                answer: 'IDK@@',\r\n                _token: $(\"meta[name='csrf-token']\").attr(\"content\")\r\n            });\r\n            //wyświetlamy poprawne odp\r\n            //JSON request\r\n            $.getJSON( \"/api/solve/\" + trio_id + \"/answer\", function(answer) {\r\n                //Fill out the sentences\r\n                fillBlanks(answer.correctAnswer);\r\n            });\r\n            //blokujemy input i button\r\n            $(\"#answer\").prop(\"disabled\", true).val(\"\");\r\n            $(\"#check-button\").prop(\"disabled\", true);\r\n            //zmieniamy button na next trio\r\n            $(\"#idk-button\").text(\"Next trio.\");\r\n            idkButtonState = 1;\r\n        } else if (idkButtonState == 1) {\r\n            // 1 - red, next trio\r\n            //Reset check button state\r\n            $(\"#check-button\")\r\n                .removeClass(\"btn-danger\")\r\n                .addClass(\"btn-primary\")\r\n                .html(\"Check\");\r\n            checkButtonState = 0;\r\n            //Clear and unlock the text input and check button\r\n            $(\"#answer\").prop(\"disabled\", false).val(\"\");\r\n            $(\"#check-button\").prop(\"disabled\", false);\r\n            //load new trio\r\n            //Make JSON request\r\n            $.getJSON(\"/api/solve\", function(trio) {\r\n                //Fill the page\r\n                loadTrio(trio, true);\r\n            });\r\n            //reset idk button state\r\n            $(\"#idk-button\").text(\"I don't know\");\r\n            idkButtonState = 0;\r\n        }\r\n\r\n        //update stats\r\n        //TODO FIXME make post request before updating stats\r\n\r\n        if(ret.stats !== undefined) {\r\n            updateStats(ret.stats);\r\n        }\r\n    });\r\n\r\n    $(\"#report-button\").on(\"click\", function (e) {\r\n        var trio_id = $(\"#trio-id\").text(),\r\n            description = $(\"#report-description\").val();\r\n\r\n        $.post(\"{{ action('ReportController@create') }}\", {\r\n                trio_id: trio_id,\r\n                description: description\r\n            }).done(function() {\r\n                var alert = $('<div class=\"alert alert-success\" role=\"alert\">Your report has been submitted. Thanks for your help!</div>');\r\n                $(\"#report-description\").val('');\r\n                $(alert).hide().prependTo(\".modal-body\").fadeIn(\"slow\").delay(3000).fadeOut(\"slow\");\r\n        });\r\n    })\r\n});\r\n"]}