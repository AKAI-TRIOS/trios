{"version":3,"sources":["solve.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["//Make magic happen\n//Function to load new trio\n//This function fills out the trio screen\n//Extracted to avoid repetition\nfunction loadTrio(trio, flip) {\n    if (flip) {\n        $(\".panel\").addClass(\"flip\");\n        setTimeout(function() {\n            $(\".panel\").removeClass(\"flip\");\n        }, 600);\n    }\n\n    var blank = \"<span class='blank'></span>\";\n    setTimeout(function() {\n        $(\"#sentences li\").html(function() {\n            return trio[this.id].replace(\"$@$\", blank);\n        });\n        $(\"#trio-id\").html(trio.id);\n    }, flip ? 300 : 0);\n\n    var sentencesArr = [trio.sentence1, trio.sentence2, trio.sentence3];\n    var sentences = encodeURIComponent(sentencesArr.join(\"\\r\\n\"));\n    location.hash = \"#\" + trio.id;\n}\n\nfunction fillBlanks(text) {\n    $(\"#sentences li .blank\").text(text);\n}\n\n$(document).ready(function() {\n    // 0 - white, check\n    // 1 - red, try again\n    // 2 - green, next trio\n    var checkButtonState = 0;\n\n    // 0 - red, i don't know\n    // 1 - red, next trio\n    var idkButtonState = 0;\n\n    var hash = location.hash.slice(1);\n    //AJAX magic\n    //On first load fetch a random trio\n    $.getJSON(\"/api/solve/\"+hash, function(trio) {\n        //Fill the page\n        loadTrio(trio, false);\n    }).fail(function() {\n        alert(\"We're having some trouble fetching a new Trio for you. :< Please try again.\");\n    });\n\n    //After user inputs answer and clicks check\n    $(\"#check-button\").on(\"click\", function (e) {\n        e.preventDefault();\n        var trio_id = parseInt($(\"#trio-id\").text());\n        $(\".panel\").removeClass(\"wrong\");\n\n        //IF the button was already green, load next trio\n        if (checkButtonState == 2) {\n            //Make JSON request\n            $.getJSON(\"/api/solve\", function(trio) {\n                //Fill the page\n                loadTrio(trio, true);\n            });\n            $(\"#check-button\")\n                .removeClass(\"btn-success\")\n                .removeClass(\"btn-danger\")\n                .addClass(\"btn-primary\")\n                .html(\"Check\");\n            $(\"#idk-button\").prop(\"disabled\", false);\n            //Clear the text input\n            $(\"#answer\").val(\"\");\n            checkButtonState = 0;\n            return;\n        }\n\n        //Get answer\n        var answer = $(\"#answer\").val();\n        //Send POST check request to /api/solve/{trio}\n        $.post(\"/api/solve/\" + trio_id, {\n            answer: answer,\n            _token: $(\"meta[name='csrf-token']\").attr(\"content\")\n        }).done(function (ret) {\n            if(ret.answer.isCorrect == true) {\n                //IF answer is correct, change button to green and change text to \"Next trio\"\n                $(\"#check-button\")\n                    .removeClass(\"btn-danger\")\n                    .removeClass(\"btn-primary\")\n                    .addClass(\"btn-success\")\n                    .html(\"Correct, next trio→\");\n                $(\"#idk-button\").prop(\"disabled\", true);\n\n                //Fill out the sentences\n                fillBlanks(ret.answer.attemptedAnswer);\n                checkButtonState = 2;\n            } else {\n                //ELSE if answer is not correct, change button to red and change text to \"try again\"\n                $(\".panel\").addClass(\"wrong\");\n                $(\"#check-button\")\n                    .removeClass(\"btn-primary\")\n                    .addClass(\"btn-danger\")\n                    .html(\"Try again\");\n                checkButtonState = 1;\n            }\n        });\n    });\n\n    //ON I don't know click or green buton click, save the click and load new random trio\n    $(\"#idk-button\").click(function (e) {\n        e.preventDefault();\n        var trio_id = $(\"#trio-id\").text();\n        $(\".panel\").removeClass(\"wrong\");\n\n        if(idkButtonState == 0) {\n            //jest napis I don't know\n            //zapisujemy click na I don't know\n            $.post(\"/api/solve/\" + trio_id, {\n                answer: 'IDK@@',\n                _token: $(\"meta[name='csrf-token']\").attr(\"content\")\n            });\n            //wyświetlamy poprawne odp\n            //JSON request\n            $.getJSON( \"/api/solve/\" + trio_id + \"/answer\", function(answer) {\n                //Fill out the sentences\n                fillBlanks(answer.correctAnswer);\n            });\n            //blokujemy input i button\n            $(\"#answer\").prop(\"disabled\", true).val(\"\");\n            $(\"#check-button\").prop(\"disabled\", true);\n            //zmieniamy button na next trio\n            $(\"#idk-button\").text(\"Next trio.\");\n            idkButtonState = 1;\n        } else if (idkButtonState == 1) {\n            // 1 - red, next trio\n            //Reset check button state\n            $(\"#check-button\")\n                .removeClass(\"btn-danger\")\n                .addClass(\"btn-primary\")\n                .html(\"Check\");\n            checkButtonState = 0;\n            //Clear and unlock the text input and check button\n            $(\"#answer\").prop(\"disabled\", false).val(\"\");\n            $(\"#check-button\").prop(\"disabled\", false);\n            //load new trio\n            //Make JSON request\n            $.getJSON(\"/api/solve\", function(trio) {\n                //Fill the page\n                loadTrio(trio, true);\n            });\n            //reset idk button state\n            $(\"#idk-button\").text(\"I don't know\");\n            idkButtonState = 0;\n        }\n    });\n\n    $(\"#report-button\").on(\"click\", function (e) {\n        var trio_id = $(\"#trio-id\").text(),\n            description = $(\"#report-description\").val();\n\n        $.post(\"{{ action('ReportController@create') }}\", {\n                trio_id: trio_id,\n                description: description\n            }).done(function() {\n                var alert = $('<div class=\"alert alert-success\" role=\"alert\">Your report has been submitted. Thanks for your help!</div>');\n                $(\"#report-description\").val('');\n                $(alert).hide().prependTo(\".modal-body\").fadeIn(\"slow\").delay(3000).fadeOut(\"slow\");\n        });\n    })\n});\n"]}